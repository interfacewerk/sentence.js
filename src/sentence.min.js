"use strict";function That(n,t){function r(){n.set(t,o.apply(null,Array.prototype.slice.call(arguments)))}var e,o,i=this;i.is=function(){var t=Array.prototype.slice.call(arguments).slice(0,arguments.length-1);return o=arguments[arguments.length-1],e=n.when.apply(n,t),e.verify?e.verify(r):e.verifies(r),i},i.remove=function(){return n.remove(e),i}}var Sentence=function(){var n=this,t={},r=[];n._get=function(){if(0===arguments.length)return t;if(1===arguments.length)return t[arguments[0]];for(var n={},r=0;r<arguments.length;r++)n[arguments[r]]=t[arguments[r]];return n},n._set=function(){var e=JSON.parse(JSON.stringify(t)),o=[];if(1===arguments.length){var i=arguments[0];for(var c in i)t[c]=i[c],o.push(c)}else for(var u=0;u<arguments.length/2;u++)t[arguments[2*u]]=arguments[2*u+1],o.push(arguments[2*u]);return setTimeout(function(){var n=t;r.forEach(function(t){try{t.process(o,n,e)}catch(r){console.error("sentence.js: an error occured when processing a when")}})},0),n},n._remove=function(t){return r.some(function(n,e){return n.interface===t?(r.splice(e,1),!0):!1}),n},n._when=function(){var t=Array.prototype.slice.call(arguments),e=new When(n,t);return r.push(e),e.interface},n.says={that:function(t){var r=new That(n,t);return r}}};Sentence.prototype.get=function(){return this._get.apply(this,arguments)},Sentence.prototype.set=function(){return this._set.apply(this,arguments)},Sentence.prototype.remove=function(){return this._remove.apply(this,arguments)},Sentence.prototype.when=function(){return this._when.apply(this,arguments)};var When=function(n,t){function r(n,t,r){try{e.do&&e.do.call(null,t,r)}catch(o){console.error("sentence.js: error on do for "+n)}}var e=this,o=[];e.onVariable=function(n){return-1===o.indexOf(n)&&o.push(n),e};var i=t;e.onAnd=function(n){return n=0===n.length?i:n,i=n,n.forEach(function(n){e.onVariable(n)}),conditions(e,n,function(t){var r=e.toVerify;e.toVerify=function(e,o){function i(){if(1===n.length)return t.call(null,e,o);var r={},i={};return n.forEach(function(n){r[n]=e[n],i[n]=o[n]}),t.call(null,r,i)}return r.call(null,e,o)&&i()}})},e.do=void 0,e.otherwise=void 0,e.anyway=void 0,t.forEach(function(n){e.onVariable(n)}),e.interface=conditions(e,t,function(n){e.toVerify=function(t,r){return n.call(null,t,r)}}),e.for=void 0;var c;e.process=function(n,t,i){if(!o.some(function(t){return-1!==n.indexOf(t)}))return e;if(e.toVerify&&e.toVerify.call(null,t,i))void 0!==e.for?c||(c=setTimeout(function(){c=void 0,r()},e.for)):r(n,t,i);else try{void 0!==e.for&&c&&(clearTimeout(c),c=void 0),e.otherwise&&e.otherwise.call(null,t,i)}catch(u){console.error("sentence.js: error on otherwise for "+n)}try{e.anyway&&e.anyway.call(null,t,i)}catch(u){console.error("sentence.js: error on anyway for "+n)}return e}},actions=function(n){var t={"do":function(r){return t.and=void 0,t.for=void 0,n.do=r,t},anyway:function(r){return t.and=void 0,t.for=void 0,n.anyway=r,t},otherwise:function(r){return t.and=void 0,t.for=void 0,n.otherwise=r,t},and:function(){return n.onAnd(Array.prototype.slice.call(arguments))},"for":function(r){return t.and=void 0,n.for=r,t}};return t},conditions=function(n,t,r){if(1===t.length){var e=t[0];return{verifies:function(t){return r(function(n,r){return t(n[e],r[e])}),actions(n)},is:function(t){return r(function(n){return n[e]===t}),actions(n)},isNot:function(t){return r(function(n){return n[e]!==t}),actions(n)},isDefined:function(){return r(function(n){return void 0!==n[e]}),actions(n)},isUndefined:function(){return r(function(n){return void 0===n[e]}),actions(n)},becomes:function(t){return r(function(n,r){return n[e]===t&&n[e]!==r[e]}),actions(n)}}}return{verify:function(e){return r(function(n,r){var o=[],i=[];return t.forEach(function(t){o.push(n[t]),i.push(r[t])}),e.apply(null,o.concat(i))}),actions(n)}}};String.prototype.milliseconds=function(){return Number(this)},String.prototype.seconds=function(){return 1e3*Number(this)},String.prototype.minutes=function(){return 6e4*Number(this)},String.prototype.hours=function(){return 36e5*Number(this)},String.prototype.days=function(){return 864e5*Number(this)},String.prototype.weeks=function(){return 6048e5*Number(this)};