"use strict";function That(n,e){function t(){n.set(e,i.apply(null,Array.prototype.slice.call(arguments)))}var o,i,r=this;r.remove=function(){return o.remove(),r},r.is=function(){var e=Array.prototype.slice.call(arguments).slice(0,arguments.length-1);return i=arguments[arguments.length-1],o=n.when.apply(n,e),o.verify?o.verify(t):o.verifies(t),r}}var Sentence=function(){var n=this,e={},t=[];n._get=function(){if(0===arguments.length)return e;if(1===arguments.length)return e[arguments[0]];for(var n={},t=0;t<arguments.length;t++)n[arguments[t]]=e[arguments[t]];return n},n._set=function(){var o=JSON.parse(JSON.stringify(e)),i=[];if(1===arguments.length){var r=arguments[0];for(var l in r)e[l]=r[l],i.push(l)}else for(var a=0;a<arguments.length/2;a++)e[arguments[2*a]]=arguments[2*a+1],i.push(arguments[2*a]);return setTimeout(function(){var n=e;t.forEach(function(e){try{e.process(i,n,o)}catch(t){console.error("sentence.js: an error occured when processing a when")}})},0),n},n._remove=function(e){return t.some(function(n,o){return n===e?(t.splice(o,1),!0):!1}),n},n._when=function(){var e=Array.prototype.slice.call(arguments),o=new When(n,e);return t.push(o),o.interface},n._process=function(o){return t.some(function(n){return n.interface===o?(setTimeout(function(){var t=[];for(var o in e)t.push(o);n.process(t,e,e)},0),!0):!1}),n},n.says={that:function(e){var t=new That(n,e);return t}}};Sentence.prototype.get=function(){return this._get.apply(this,arguments)},Sentence.prototype.set=function(){return this._set.apply(this,arguments)},Sentence.prototype.when=function(){return this._when.apply(this,arguments)},Sentence.prototype.process=function(n){return this._process.call(this,n)};var When=function(n,e){function t(n,e,t){try{o.do&&o.do.call(null,e,t)}catch(i){console.error("sentence.js: error on do for "+n)}}var o=this,i=[];o.remove=function(){n._remove(o)},o.onVariable=function(n){return-1===i.indexOf(n)&&i.push(n),o};var r=e;o.onAnd=function(n){return n=0===n.length?r:n,r=n,n.forEach(function(n){o.onVariable(n)}),conditions(o,n,function(e){var t=o.toVerify;o.toVerify=function(o,i){function r(){if(1===n.length)return e.call(null,o,i);var t={},r={};return n.forEach(function(n){t[n]=o[n],r[n]=i[n]}),e.call(null,t,r)}return t.call(null,o,i)&&r()}})},o.do=void 0,o.otherwise=void 0,o.anyway=void 0,e.forEach(function(n){o.onVariable(n)}),o.interface=conditions(o,e,function(n){o.toVerify=function(e,t){return n.call(null,e,t)}}),o.interface.processWithOldValues=function(e){var t={},i=[];for(var r in e)i.push(r),t[r]=n.get(r);return o.process(i,t,e),o.interface},o.for=void 0;var l;o.process=function(n,e,r){if(!i.some(function(e){return-1!==n.indexOf(e)}))return o;if(o.toVerify&&o.toVerify.call(null,e,r))void 0!==o.for?l||(l=setTimeout(function(){l=void 0,t()},o.for)):t(n,e,r);else try{void 0!==o.for&&l&&(clearTimeout(l),l=void 0),o.otherwise&&o.otherwise.call(null,e,r)}catch(a){console.error("sentence.js: error on otherwise for "+n)}try{o.anyway&&o.anyway.call(null,e,r)}catch(a){console.error("sentence.js: error on anyway for "+n)}return o}},actions=function(n){var e={"do":function(t){return e.and=void 0,e.for=void 0,n.do=t,e},anyway:function(t){return e.and=void 0,e.for=void 0,n.anyway=t,e},otherwise:function(t){return e.and=void 0,e.for=void 0,n.otherwise=t,e},and:function(){return n.onAnd(Array.prototype.slice.call(arguments))},"for":function(t){return e.and=void 0,n.for=t,e},remove:function(){n.remove()}};return e},conditions=function(n,e,t){if(1===e.length){var o=e[0];return{remove:function(){n.remove()},verifies:function(e){return t(function(n,t){return e(n[o],t[o])}),actions(n)},is:function(e){return t(function(n){return n[o]===e}),actions(n)},isNot:function(e){return t(function(n){return n[o]!==e}),actions(n)},isDefined:function(){return t(function(n){return void 0!==n[o]}),actions(n)},isUndefined:function(){return t(function(n){return void 0===n[o]}),actions(n)},becomes:function(e){return t(function(n,t){return n[o]===e&&n[o]!==t[o]}),actions(n)},updates:function(){return t(function(){return!0}),actions(n)}}}return{remove:function(){n.remove()},verify:function(o){return t(function(n,t){var i=[],r=[];return e.forEach(function(e){i.push(n[e]),r.push(t[e])}),o.apply(null,i.concat(r))}),actions(n)}}};String.prototype.milliseconds=function(){return Number(this)},String.prototype.seconds=function(){return 1e3*Number(this)},String.prototype.minutes=function(){return 6e4*Number(this)},String.prototype.hours=function(){return 36e5*Number(this)},String.prototype.days=function(){return 864e5*Number(this)},String.prototype.weeks=function(){return 6048e5*Number(this)};